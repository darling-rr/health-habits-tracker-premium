:root { --bg:#f6f7fb; --card:#fff; --text:#111; --muted:#666; --border:#e6e7ee; }
:root[data-theme="dark"] { --bg:#0b1020; --card:#121a33; --text:#f2f4ff; --muted:#b7bdd8; --border:#273054; }

*{box-sizing:border-box}
body{margin:0;font-family:system-ui,Arial;background:var(--bg);color:var(--text)}
.header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid var(--border)}
.header-actions button{margin-left:8px}

.controls{display:flex;gap:10px;padding:14px 20px;flex-wrap:wrap}
.controls input,.controls select{padding:10px;border:1px solid var(--border);border-radius:10px;background:var(--card);color:var(--text)}

.panel{padding:0 20px 30px}
.stats{margin:10px 0;color:var(--muted)}

/* ✅ Form: se adapta a más campos (auto-fit) */
.form{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap:10px;
}
.form input,.form select,.form button{
  padding:10px;border-radius:10px;border:1px solid var(--border);
  background:var(--card);color:var(--text)
}
.form button{cursor:pointer}

/* ✅ Botones header/controls un poco más “premium” */
button{
  padding:10px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  cursor:pointer;
}
button:hover{opacity:.95}

.list{list-style:none;padding:0;margin:16px 0;display:grid;gap:12px}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px}
.card.done{opacity:.75}
.card .top{display:flex;justify-content:space-between;gap:10px;align-items:center}
.card .title{display:flex;gap:10px;align-items:center}
.card .desc{margin:10px 0;color:var(--muted)}
.meta{display:flex;gap:12px;color:var(--muted);font-size:13px;margin-top:8px;flex-wrap:wrap}

.badge{
  padding:4px 8px;border-radius:999px;border:1px solid var(--border);
  font-size:12px;color:var(--muted);
  transition: border-color 220ms ease, transform 160ms ease;
}
.pr-high{border-color:#ff6b6b}
.pr-medium{border-color:#ffd43b}
.pr-low{border-color:#74c0fc}

.tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.tag{font-size:12px;padding:3px 8px;border-radius:999px;border:1px solid var(--border);color:var(--muted)}

.actions{display:flex;gap:10px;margin-top:10px}
.actions button{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--text);cursor:pointer}
.actions .danger{border-color:#ff6b6b}

.modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.35);padding:20px}
.modal.open{display:grid}
.modal-card{width:min(520px,100%);background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px}
.modal-header{display:flex;justify-content:space-between;align-items:center}
.modal-form{display:grid;gap:10px;margin-top:10px}
.modal-form input,.modal-form select,.modal-form button{padding:10px;border-radius:10px;border:1px solid var(--border);background:var(--bg);color:var(--text)}

.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);padding:10px 14px;border-radius:999px;border:1px solid var(--border);background:var(--card);color:var(--text);opacity:0;pointer-events:none;transition:.2s}
.toast.show{opacity:1}

@media (max-width: 900px){
  .form{grid-template-columns:1fr;}
}

/* ---------- Progress ---------- */
.progress-wrap{
  margin: 10px 0 14px;
  padding: 12px;
  border: 1px solid var(--border);
  background: var(--card);
  border-radius: 16px;
}
.progress-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 8px;
}
.progress-track{
  height: 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--bg);
  overflow: hidden;
}
.progress-bar{
  height: 100%;
  width: 0%;
  border-radius: 999px;
  background: var(--text);  /* ✅ más consistente */
  opacity: .85;
  transform-origin: left;
  transition: width 420ms ease;
}

/* ---------- Card micro-interactions ---------- */
.card{
  transition: transform 160ms ease, box-shadow 160ms ease, opacity 200ms ease;
  will-change: transform, opacity;
}
.card:hover{
  transform: translateY(-2px);
}
.card.dragging{
  opacity: .65;
  transform: scale(0.99);
}

/* ---------- Enter/Exit animations ---------- */
.card.enter{ opacity: 0; transform: translateY(8px); }
.card.enter-active{ opacity: 1; transform: translateY(0); }
.card.exit{ opacity: 0; transform: translateY(8px); }

/* ---------- Toast smoother ---------- */
.toast{
  transition: opacity 200ms ease, transform 200ms ease;
  transform: translate(-50%, 6px);
}
.toast.show{ transform: translate(-50%, 0); }

/* ---------- Modal smoother ---------- */
.modal{ transition: opacity 160ms ease; opacity: 0; }
.modal.open{ opacity: 1; }
.modal-card{ transform: translateY(8px); transition: transform 180ms ease; }
.modal.open .modal-card{ transform: translateY(0); }

/* Modal form fields (extra) */
.field { display:grid; gap:6px; margin-top:10px; }
.field span { font-size:12px; color: var(--muted); }
.field input, .field select {
  padding:10px; border-radius:10px; border:1px solid var(--border);
  background: var(--bg); color: var(--text);
}
.grid-2 { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
@media (max-width: 600px){ .grid-2 { grid-template-columns:1fr; } }

/* ✅ Badge semanal con color por cumplimiento */
.badge-week-low { border-color: #ff6b6b; }
.badge-week-mid { border-color: #ffd43b; }
.badge-week-high { border-color: #51cf66; }

/* ---------- Week dots ---------- */
.habit-week {
  display: flex;
  gap: 6px;
  margin-top: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.day-dot {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: transparent;
  opacity: .9;
  transition: transform 160ms ease, border-color 220ms ease, opacity 220ms ease;
}

.day-dot.on {
  border-color: var(--text);
  opacity: 1;
}

.day-dot:hover { transform: scale(1.12); }

.week-label {
  font-size: 12px;
  color: var(--muted);
  margin-left: 4px;
}

/* Weekly global progress */
.week-progress-wrap{
  margin: 10px 0 14px;
  padding: 12px;
  border: 1px solid var(--border);
  background: var(--card);
  border-radius: 16px;
}
.week-progress-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 8px;
}
.week-progress-track{
  height: 10px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--bg);
  overflow: hidden;
}
.week-progress-bar{
  height:100%;
  width:0%;
  border-radius:999px;
  background: var(--text);
  opacity: .75;
  transition: width 420ms ease, border-color 220ms ease;
}

/* Week view table */
.week-view{
  border: 1px solid var(--border);
  background: var(--card);
  border-radius: 16px;
  overflow: hidden;
}
.week-table{
  width: 100%;
  border-collapse: collapse;
}
.week-table th, .week-table td{
  border-bottom: 1px solid var(--border);
  padding: 10px;
  font-size: 13px;
  vertical-align: middle;
}
.week-table th{
  color: var(--muted);
  font-weight: 600;
  background: var(--bg);
}
.week-habit{
  display:flex;
  gap:10px;
  align-items:center;
}
.week-habit .name{ font-weight: 600; }
.week-cell{ text-align:center; }

.week-toggle{
  width: 18px;
  height: 18px;
  border-radius: 6px;
  display:inline-block;
  border: 1px solid var(--border);
  transition: transform 160ms ease, border-color 220ms ease, opacity 220ms ease;
  opacity: .9;
  cursor: pointer;
}
.week-toggle.on{
  border-color: var(--text);
  opacity: 1;
}
.week-toggle:hover{ transform: scale(1.08); }

.week-legend{
  padding: 10px 12px;
  color: var(--muted);
  font-size: 12px;
  border-top: 1px solid var(--border);
}

/* Animación suave goalPerWeek */
.goal-animated {
  overflow: hidden;
  transition: opacity 220ms ease, transform 220ms ease, max-height 260ms ease;
  max-height: 60px;
  opacity: 1;
  transform: translateY(0);
}

.goal-animated.hidden {
  max-height: 0;
  opacity: 0;
  transform: translateY(-4px);
}

/* JS mouseover helper */
.card.hovered .hint{
  display: inline;
}
.hint{
  font-size: 12px;
  color: var(--muted);
  border: 1px dashed var(--border);
  padding: 3px 8px;
  border-radius: 999px;
}